<form id="hostearHeladeraForm" action="/colaboraciones/hostear" method="POST">
    <div class="form-group mb-3">
        <label for="nombreHeladera">Nombre de la Heladera</label>
        <input type="text" class="form-control" id="nombreHeladera" name="nombreHeladera" placeholder="Nombre de la heladera" required>
    </div>
    <div class="form-group mb-3">
        <label for="cantMaxViandas">Capacidad Máxima de Viandas</label>
        <input type="number" class="form-control" id="cantMaxViandas" name="cantMaxViandas" placeholder="Cantidad máxima de viandas" required>
    </div>

    <div class="form-group mb-3">
        <label for="modeloHeladera">Modelo de la heladera</label>
        <input type="text" class="form-control" id="modeloHeladera" name="modeloHeladera" placeholder="Modelo de la heladera" required>
    </div>

    <div class="form-group mb-3">
        <label for="ubicacion">Ubicación de la Heladera</label>
        <!-- Mapa Leaflet para selección de ubicación -->
        <div id="map" style="height: 300px; border: 1px solid #ccc; border-radius: 4px;"></div>
        <input type="hidden" id="latitud" name="latitud">
        <input type="hidden" id="longitud" name="longitud">
        <input type="text" class="form-control mt-2" id="direccion" name="direccion" placeholder="Dirección" readonly>
    </div>

    <button type="submit" class="btn btn-primary btn-block">Hostear Heladera</button>
</form>

<script>
    // Inicializar el mapa Leaflet
    var map = L.map('map').setView([-34.6037, -58.3816], 13); // Inicializa en Buenos Aires
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19
    }).addTo(map);

    // Manejar selección de ubicación
    map.on('click', function(e) {
        var lat = e.latlng.lat;
        var lng = e.latlng.lng;
        document.getElementById('latitud').value = lat;
        document.getElementById('longitud').value = lng;

        // Realizar geocodificación inversa usando Nominatim
        fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lng}`)
            .then(response => response.json())
            .then(data => {
                var address = data.display_name; // La dirección completa
                document.getElementById('direccion').value = address; // Establecer el campo de dirección
            })
            .catch(error => {
                console.error('Error al obtener la dirección:', error);
                document.getElementById('direccion').value = "No se pudo obtener la dirección";
            });
    });
</script>